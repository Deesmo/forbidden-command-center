{% extends "base.html" %}
{% block title %}Dashboard{% endblock %}

{% block content %}
<!-- BRAND HERO BANNER -->
<div style="position: relative; margin: -16px -16px 20px; padding: 24px 20px 20px; background: linear-gradient(135deg, rgba(200,164,94,0.06) 0%, rgba(17,31,58,0.8) 40%, rgba(11,20,38,0.95) 100%); border-bottom: 1px solid rgba(200,164,94,0.15); overflow: hidden;">
    <!-- Art deco corner ornaments -->
    <div style="position: absolute; top: 12px; left: 16px; width: 20px; height: 20px; border-top: 1px solid rgba(200,164,94,0.3); border-left: 1px solid rgba(200,164,94,0.3);"></div>
    <div style="position: absolute; top: 12px; right: 16px; width: 20px; height: 20px; border-top: 1px solid rgba(200,164,94,0.3); border-right: 1px solid rgba(200,164,94,0.3);"></div>
    <div style="position: absolute; bottom: 12px; left: 16px; width: 20px; height: 20px; border-bottom: 1px solid rgba(200,164,94,0.3); border-left: 1px solid rgba(200,164,94,0.3);"></div>
    <div style="position: absolute; bottom: 12px; right: 16px; width: 20px; height: 20px; border-bottom: 1px solid rgba(200,164,94,0.3); border-right: 1px solid rgba(200,164,94,0.3);"></div>
    <!-- Gold art deco diamond -->
    <div style="position: absolute; right: 24px; top: 50%; transform: translateY(-50%); font-size: 3rem; color: rgba(200,164,94,0.06); font-family: 'Cormorant Garamond', serif;">‚óÜ</div>
    <div class="page-header" style="margin-bottom: 0; position: relative; z-index: 2;">
        <h1 style="font-size: 1.5rem; margin-bottom: 2px;">Command Center</h1>
        <p class="subtitle" style="color: var(--gold-dark); font-size: 1.05rem; letter-spacing: 0.12em; text-transform: uppercase;">Brand Command Center</p>
    </div>
</div>

<!-- STATS -->
<div class="stats-grid">
    <div class="stat-card accent">
        <div class="stat-value">{{ stats.published }}</div>
        <div class="stat-label">Published</div>
    </div>
    <div class="stat-card">
        <div class="stat-value">{{ stats.scheduled }}</div>
        <div class="stat-label">Scheduled</div>
    </div>
    <div class="stat-card">
        <div class="stat-value">{{ stats.drafts }}</div>
        <div class="stat-label">Drafts</div>
    </div>
    <div class="stat-card">
        <div class="stat-value">{{ stats.connected_platforms }}</div>
        <div class="stat-label">Platforms</div>
    </div>
</div>

<!-- BRAND HERO -->
<div style="position: relative; margin-bottom: 20px; border-radius: var(--radius-lg); overflow: hidden; border: 1px solid var(--border); height: 160px;">
    <img src="/static/photos/bottles-duo.jpg" alt="Forbidden" style="position: absolute; inset: 0; width: 100%; height: 100%; object-fit: cover; opacity: 0.35;">
    <div style="position: relative; z-index: 1; height: 100%; display: flex; align-items: center; padding: 20px;">
        <div style="flex: 1;">
            <div style="font-family: 'Cormorant Garamond', serif; font-size: 1.3rem; color: var(--gold); font-weight: 700; letter-spacing: 0.05em; text-shadow: 0 2px 8px rgba(0,0,0,0.5);">FORBIDDEN</div>
            <div style="font-size: 1.02rem; color: var(--text-secondary); margin-top: 4px;">A Twist on Tradition</div>
            <div style="display: flex; gap: 12px; margin-top: 12px;">
                <a href="/compose" style="font-size: 1.02rem; color: var(--bg-dark); background: var(--gold); padding: 6px 14px; border-radius: 20px; text-decoration: none; font-weight: 600;">New Post</a>
                <a href="/photos" style="font-size: 1.02rem; color: var(--gold); border: 1px solid var(--gold-dark); padding: 6px 14px; border-radius: 20px; text-decoration: none;">Photos ‚Üí</a>
            </div>
        </div>
        <div style="display: flex; gap: 8px;">
            <img src="https://cdn.prod.website-files.com/6499a35eececddbc57190649/66343a609f3e535af4191fab_Small%20Batch%20Select.webp" alt="Small Batch" style="height: 110px; object-fit: contain; filter: drop-shadow(0 8px 24px rgba(0,0,0,0.6));">
            <img src="https://cdn.prod.website-files.com/6499a35eececddbc57190649/66343acc2ac98893e781d222_single-barrel__dark.webp" alt="Single Barrel" style="height: 110px; object-fit: contain; filter: drop-shadow(0 8px 24px rgba(0,0,0,0.6));">
        </div>
    </div>
</div>

<!-- QUICK ACTIONS -->
<div class="quick-actions">
    <a href="/compose" class="quick-action">
        <div class="qa-icon">‚úç</div>
        <div class="qa-label">New Post</div>
    </a>
    <a href="/compose?ai=1" class="quick-action">
        <div class="qa-icon">‚ú¶</div>
        <div class="qa-label">AI Generate</div>
    </a>
    <a href="/templates" class="quick-action">
        <div class="qa-icon">üìã</div>
        <div class="qa-label">Templates</div>
    </a>
    <a href="/platforms" class="quick-action">
        <div class="qa-icon">‚ö°</div>
        <div class="qa-label">Platforms</div>
    </a>
    <a href="/mash-analytics" class="quick-action">
        <div class="qa-icon">üìä</div>
        <div class="qa-label">Mash Data</div>
    </a>
    <a href="/outreach" class="quick-action">
        <div class="qa-icon">üéØ</div>
        <div class="qa-label">Outreach</div>
    </a>
    <a href="/ai-studio" class="quick-action">
        <div class="qa-icon">üé®</div>
        <div class="qa-label">AI Studio</div>
    </a>
</div>

<!-- UPCOMING SCHEDULED -->
{% if scheduled %}
<div class="card">
    <div class="card-header">
        <h2>Upcoming</h2>
        <a href="/queue?status=scheduled" class="btn btn-ghost btn-sm">View All</a>
    </div>
    {% for post in scheduled %}
    <div class="calendar-item">
        <div class="calendar-time">{{ post.scheduled_at|shortdate }}</div>
        <div class="calendar-item-content">{{ post.content[:100] }}{% if post.content|length > 100 %}...{% endif %}</div>
    </div>
    {% endfor %}
</div>
{% endif %}

<!-- RECENT POSTS -->
<div class="card">
    <div class="card-header">
        <h2>Recent Posts</h2>
        <a href="/queue" class="btn btn-ghost btn-sm">View All</a>
    </div>
    
    {% if recent_posts %}
        {% for post in recent_posts %}
        <div class="post-card" style="border: none; padding: 10px 0; margin-bottom: 0;">
            <div class="post-meta">
                <span class="status-badge {{ post.status }}">
                    <span class="status-dot {{ post.status }}"></span>
                    {{ post.status }}
                </span>
                <span class="text-xs text-muted">{{ post.created_at|timeago }}</span>
            </div>
            <div class="post-content" style="font-size: 1rem; margin-bottom: 6px;">
                {{ post.content[:120] }}{% if post.content|length > 120 %}...{% endif %}
            </div>
            <div class="post-platforms">
                {% for p in post.platforms %}
                <span class="platform-dot {{ p.platform_name }}"></span>
                {% endfor %}
            </div>
        </div>
        {% if not loop.last %}<hr style="border: none; border-top: 1px solid var(--border); margin: 4px 0;">{% endif %}
        {% endfor %}
    {% else %}
        <div class="empty-state">
            <div class="empty-icon">‚úç</div>
            <div class="empty-text">No posts yet. Create your first one!</div>
            <a href="/compose" class="btn btn-primary">Compose Post</a>
        </div>
    {% endif %}
</div>

<!-- CONNECTED PLATFORMS STATUS -->
<div class="card">
    <div class="card-header">
        <h2>Platforms</h2>
        <a href="/platforms" class="btn btn-ghost btn-sm">Manage</a>
    </div>
    
    <!-- Social Media -->
    <div style="font-size: 1rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.1em; margin-bottom: 4px;">Social Media</div>
    {% for p in platforms %}
    {% if p.name in ['twitter', 'bluesky', 'facebook', 'linkedin', 'instagram'] %}
    <div style="display: flex; align-items: center; justify-content: space-between; padding: 6px 0; border-bottom: 1px solid var(--border);">
        <div style="display: flex; align-items: center; gap: 10px;">
            <span class="platform-dot {{ p.name }}"></span>
            <span class="text-sm">{{ p.display_name }}</span>
        </div>
        <span class="text-xs {% if p.connected %}text-gold{% else %}text-muted{% endif %}">
            {% if p.connected %}Connected{% else %}Not connected{% endif %}
        </span>
    </div>
    {% endif %}
    {% endfor %}
    
    <!-- AI Tools -->
    <div style="font-size: 1rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.1em; margin-top: 10px; margin-bottom: 4px;">AI Tools</div>
    {% for p in platforms %}
    {% if p.name in ['openai', 'runway'] %}
    <div style="display: flex; align-items: center; justify-content: space-between; padding: 6px 0; border-bottom: 1px solid var(--border);">
        <div style="display: flex; align-items: center; gap: 10px;">
            <span style="font-size: 1.05rem;">{{ p.icon }}</span>
            <span class="text-sm">{{ p.display_name }}</span>
        </div>
        <span class="text-xs {% if p.connected %}text-gold{% else %}text-muted{% endif %}">
            {% if p.connected %}Connected{% else %}Not connected{% endif %}
        </span>
    </div>
    {% endif %}
    {% endfor %}
    
    <!-- Blog / SEO Platforms -->
    <div style="font-size: 1rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.1em; margin-top: 10px; margin-bottom: 4px;">Blog / SEO</div>
    {% for p in platforms %}
    {% if p.name in ['medium', 'wordpress', 'blogger', 'reddit', 'pinterest', 'quora'] %}
    <div style="display: flex; align-items: center; justify-content: space-between; padding: 6px 0; {% if not loop.last %}border-bottom: 1px solid var(--border);{% endif %}">
        <div style="display: flex; align-items: center; gap: 10px;">
            <span style="font-size: 1.05rem;">{{ p.icon }}</span>
            <span class="text-sm">{{ p.display_name }}</span>
        </div>
        <span class="text-xs {% if p.connected %}text-gold{% else %}text-muted{% endif %}">
            {% if p.connected %}Connected{% elif p.name == 'quora' %}Manual{% else %}Not connected{% endif %}
        </span>
    </div>
    {% endif %}
    {% endfor %}
</div>

<!-- BLOG HUB ACTIVITY -->
<div class="card">
    <div class="card-header">
        <h2>Blog Hub</h2>
        <a href="/blog-hub" class="btn btn-ghost btn-sm">Open ‚Üí</a>
    </div>
    <div class="stats-grid" style="margin-bottom: 12px;">
        <div style="text-align: center;">
            <div style="font-size: 1.2rem; color: var(--gold); font-weight: 700;">{{ blog_stats.total }}</div>
            <div style="font-size: 1.05rem; color: var(--text-muted);">Articles</div>
        </div>
        <div style="text-align: center;">
            <div style="font-size: 1.2rem; color: #4ade80; font-weight: 700;">{{ blog_stats.published }}</div>
            <div style="font-size: 1.05rem; color: var(--text-muted);">Published</div>
        </div>
        <div style="text-align: center;">
            <div style="font-size: 1.2rem; color: var(--text-secondary); font-weight: 700;">{{ blog_stats.drafts }}</div>
            <div style="font-size: 1.05rem; color: var(--text-muted);">Drafts</div>
        </div>
        <div style="text-align: center;">
            <div style="font-size: 1.2rem; color: var(--text-secondary); font-weight: 700;">{{ blog_stats.topics }}</div>
            <div style="font-size: 1.05rem; color: var(--text-muted);">Topics</div>
        </div>
    </div>
    <div style="font-size: 1.05rem; color: #4ade80; text-align: center; padding: 6px; background: rgba(74,222,128,0.06); border-radius: 6px;">
        ‚óè Auto-posting active ‚Äî Mon/Wed/Fri blogs, Tue/Thu Reddit
    </div>
</div>

<!-- ACTIVITY FEED -->
{% if activity %}
<div class="card">
    <div class="card-header">
        <h2>Activity</h2>
    </div>
    {% for a in activity %}
    <div class="activity-item">
        <div class="activity-icon {% if 'created' in a.action %}created{% elif 'published' in a.action %}published{% elif 'deleted' in a.action %}deleted{% else %}updated{% endif %}">
            {% if 'created' in a.action %}Ôºã{% elif 'published' in a.action %}‚úì{% elif 'deleted' in a.action %}‚úï{% else %}‚Üª{% endif %}
        </div>
        <div>
            <div class="activity-text">{{ a.details }}</div>
            <div class="activity-time">{{ a.created_at|timeago }}</div>
        </div>
    </div>
    {% endfor %}
</div>
{% endif %}
{% endblock %}
